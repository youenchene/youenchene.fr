---
author:
  image: //lh5.googleusercontent.com/-A-K28QrsbqY/AAAAAAAAAAI/AAAAAAAAoeE/WxTOlDCDJDU/s512-c/photo.jpg
  name: Youen Chene
  url: https://plus.google.com/102338778856350576971?rel=author
blogger:
  postid: "5862409594498245094"
  siteid: "4413872543526237731"
categories:
- java
- GWT
- driveo
date: "2010-01-08T09:02:00Z"
description: null
guid: tag:blogger.com,1999:blog-4413872543526237731.post-5862409594498245094
title: 'GWT avancé : Event Bus, MVP et Code Splitting'
updated: "2010-01-08 10:20:07"
url: /2010/01/gwt-avance-event-bus-mvp-et-code
aliases :
- /2010/01/gwt-avance-event-bus-mvp-et-code.html
uuid: "5862409594498245094"
---

<div >
<a  href="/assets/external/1.bp.blogspot.com/_7LQ1EXHnw30/S0b1PLGcZOI/AAAAAAAADVg/69dv45oE788/s1600-h/toolkit_proposed_icon_128.png"><img src="/assets/external/1.bp.blogspot.com/_7LQ1EXHnw30/S0b1PLGcZOI/AAAAAAAADVg/69dv45oE788/s200/toolkit_proposed_icon_128.png"  id="BLOGGER_PHOTO_ID_5424292442241000674" /></a><span>Pour ce début d'année 2010, voici un nouvel article sur l'utilisation de GWT avancé. Cela concerne des techniques de programmation permettant de construire des applications <a href="http://code.google.com/webtoolkit/">GWT</a> ambitieuse maitrisable ("Large Scale Application".</span><br /><br /><span><span>Les enjeux</span></span><br /><br />Derrière ces articles techniques, il y a aussi des enjeux commerciaux.<br /><br /><span>L'impression de vitesse</span> est très importante pour les tous les utilisateurs. Pour <a href="http://www.driveo.fr/">Driveo</a>, c'est un critère discriminant dans le choix de la solution par rapports aux concurrents offline. Cela passe donc par <span>la maitrise du premier chargement</span> et donc<span> la taille du fichier javascript généré par GWT</span>.<br /><br /><span>L'agilité</span> à corriger, maintenir et à faire évoluer l'application est aussi <span>un facteur très différenciateur</span> pour <a href="http://www.driveo.fr/">Driveo</a> par rapport à la <span>concurrence offline</span> qui évolue plus lentement. Pour cela, la maintenabilité et la <span>maitrise de la croissance</span> d'une application doit passer des<span> pratiques de conception</span> le permettant.<br /><br /><span >Event Bus et MVP</span><br /><br />Cette partie est la plus compliquée. Cependant, le paragraphe va être court. En effet, il y a la présentation donnée au <a href="http://www.normandyjug.org/">normandy jug</a> et surtout Google a surtout un article complet dessus.<br /><br />Vous trouverez donc <a href="http://www.youenchene.fr/2009/12/normandy-jug-presentation-gwt-avance-et.html">ma présentation au normandyjug</a> qui évoque l'objectif de découplage des composants d'une application.<br /><br />Enfin, l'équipe GWT a sortie un tutoriel nommé <a href="http://code.google.com/intl/fr/webtoolkit/doc/latest/tutorial/mvp-architecture.html">Large scale application development and MVP</a>. <a href="http://code.google.com/intl/fr/webtoolkit/doc/latest/tutorial/projects/Contacts.zip">Le code source de l'exemple est même disponible</a>. L'exemple comprend même une utilisation de la gestion de l'historique avec GWT.<br /><br />Le code de <a href="http://www.driveo.fr/">Driveo</a> est cours de migration vers ces pratiques (20% sur Bus Events, 10% sur MVP). Les premiers avantage sont une diminution du code et meilleur maitrise de la maintenance.<br /><br />Cependant, la migration en mode événementiel est à prendre avec des précautions car cela influence la conception complète de l'application. Il faudra veiller à éviter la prise en compte d'événement en double (par le bus events (nouveau code) et par listener/handler (ancien code)) car la localisation de prise en compte de l'évènement n'est pas la même.<br /><br />Enfin, la partie la plus importante est le découplage des modules constituant l'application. Cela va permettre un code splitting plus efficace.<br /><br /><span><span>Code Splitting</span><br /></span><br />Par le simple ajout de <span>GWT.runAsync</span>, dans l'embranchement principale de l'application (le menu, l'accueil, le tableau de bord), il est possible de reporter le chargement de certains modules en fonction du profil de l'utilisateur ou du module (si c'est un module peu fréquemment utilisé).<br /><br />Le problème c'est que c'est efficace uniquement si les modules sont correctement découplés. On en revient donc aux pratiques de Bus Events et MVP.<br /><br />Heureusement, pour pouvoir analyser ce découplage, l'équipe de GWT a ajouté l'analyse SOYC de votre code (SOYC = Story Of Your Compile). Cela vous permet, entre autre, d'avoir des rapports HTML qui permettent de savoir dans quel bloc de javascript compilés vos classes GWT se trouvent.<br /><br />Pour cela, il faut ajouter les arguments " -compileReport -XsoycDetailed extra /path/path/report/application " à votre ligne de compilation. Attention, pour moi, avec ses options la compilation est passé de 9mn à 33mn! Il ne faut donc pas les laisser par défaut.<br /><br />Pour conclure voici un graphique d'évolution de la taille de <a href="http://www.driveo.fr/">Driveo</a>  (Javascript compilé par GWT + CSS + noyau d'images) :<br /><div><a  href="/assets/external/4.bp.blogspot.com/_7LQ1EXHnw30/S0cE6MuqhiI/AAAAAAAADVo/tBtKkWlK4-w/s1600-h/Suivi+%C3%A9vol+Driveo.png"><img src="/assets/external/4.bp.blogspot.com/_7LQ1EXHnw30/S0cE6MuqhiI/AAAAAAAADVo/tBtKkWlK4-w/s400/Suivi+%C3%A9vol+Driveo.png"  id="BLOGGER_PHOTO_ID_5424309674086925858" /></a><span><span>Cliquez sur l'image pour voir les détails</span><br /></span></div>
</div>